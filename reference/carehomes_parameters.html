<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Parameters for the carehomes model — carehomes_parameters • sircovid</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Parameters for the carehomes model — carehomes_parameters" />
<meta property="og:description" content="Parameters for the &quot;carehomes&quot; model." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sircovid</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mrc-ide/sircovid/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parameters for the carehomes model</h1>
    <small class="dont-index">Source: <a href='https://github.com/mrc-ide/sircovid/blob/master/R/carehomes.R'><code>R/carehomes.R</code></a></small>
    <div class="hidden name"><code>carehomes_parameters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Parameters for the "<a href='carehomes.html'>carehomes</a>" model.</p>
    </div>

    <pre class="usage"><span class='fu'>carehomes_parameters</span><span class='op'>(</span>
  <span class='va'>start_date</span>,
  <span class='va'>region</span>,
  beta_date <span class='op'>=</span> <span class='cn'>NULL</span>,
  beta_value <span class='op'>=</span> <span class='cn'>NULL</span>,
  severity <span class='op'>=</span> <span class='cn'>NULL</span>,
  p_death_carehome <span class='op'>=</span> <span class='fl'>0.7</span>,
  sero_specificity <span class='op'>=</span> <span class='fl'>0.9</span>,
  sero_sensitivity <span class='op'>=</span> <span class='fl'>0.99</span>,
  progression <span class='op'>=</span> <span class='cn'>NULL</span>,
  eps <span class='op'>=</span> <span class='fl'>0.1</span>,
  m_CHW <span class='op'>=</span> <span class='fl'>4e-06</span>,
  m_CHR <span class='op'>=</span> <span class='fl'>5e-05</span>,
  pillar2_specificity <span class='op'>=</span> <span class='fl'>0.99</span>,
  pillar2_sensitivity <span class='op'>=</span> <span class='fl'>0.99</span>,
  react_specificity <span class='op'>=</span> <span class='fl'>0.99</span>,
  react_sensitivity <span class='op'>=</span> <span class='fl'>0.99</span>,
  p_NC <span class='op'>=</span> <span class='fl'>0.01</span>,
  strain_transmission <span class='op'>=</span> <span class='fl'>1</span>,
  strain_seed_date <span class='op'>=</span> <span class='cn'>NULL</span>,
  strain_seed_value <span class='op'>=</span> <span class='cn'>NULL</span>,
  rel_susceptibility <span class='op'>=</span> <span class='fl'>1</span>,
  rel_p_sympt <span class='op'>=</span> <span class='fl'>1</span>,
  rel_p_hosp_if_sympt <span class='op'>=</span> <span class='fl'>1</span>,
  rel_infectivity <span class='op'>=</span> <span class='fl'>1</span>,
  vaccine_progression_rate <span class='op'>=</span> <span class='cn'>NULL</span>,
  vaccine_uptake <span class='op'>=</span> <span class='cn'>NULL</span>,
  vaccine_daily_doses <span class='op'>=</span> <span class='fl'>0</span>,
  waning_rate <span class='op'>=</span> <span class='fl'>0</span>,
  model_pcr_and_serology_user <span class='op'>=</span> <span class='fl'>1</span>,
  exp_noise <span class='op'>=</span> <span class='fl'>1e+06</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>start_date</th>
      <td><p>Thee start date, as a <code><a href='sircovid_date.html'>sircovid_date()</a></code> (i.e.,
the number of days into 2020)</p></td>
    </tr>
    <tr>
      <th>region</th>
      <td><p>The region to run the model for. This will bee used
to get population data, which is currently fixed within the
package and is limited to "uk", the four constituent nations
("england", "wales", "scotland", "northern_ireland") and the 7
NHS regions (e.g., "midlands"). These names are case
insensitive.</p></td>
    </tr>
    <tr>
      <th>beta_date</th>
      <td><p>A vector of dates for changes in beta (the
contact rate parameter), or <code>NULL</code> if a single value is used for
all times (see <code><a href='sircovid_parameters_beta.html'>sircovid_parameters_beta()</a></code>, where this is
passed as <code>date</code>).</p></td>
    </tr>
    <tr>
      <th>beta_value</th>
      <td><p>A vector of values for beta (the contact rate
parameter). If not given, and if <code>beta_date</code> is <code>NULL</code> then a
value of 0.08 will be used through the whole simulation,
otherwise if <code>beta_date</code> is <code>NULL</code> this must be a scalar. If
<code>beta_date</code> is given then <code>beta_date</code> and <code>beta_value</code> must have
the same length (see <code><a href='sircovid_parameters_beta.html'>sircovid_parameters_beta()</a></code>, where this is
passed as <code>value</code>).</p></td>
    </tr>
    <tr>
      <th>severity</th>
      <td><p>Severity data, via Bob Verity's <code>markovid</code>
package. This needs to be <code>NULL</code> (use the default bundled data
version in the package), a <a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a> object (for raw severity
data) or a list (for data that has already been processed by
<code>sircovid</code> for use).  New severity data comes from Bob Verity
via the markovid package, and needs to be carefully calibrated
with the progression parameters.</p></td>
    </tr>
    <tr>
      <th>p_death_carehome</th>
      <td><p>Probability of death within carehomes
(conditional on having an "inflenza-like-illness")</p></td>
    </tr>
    <tr>
      <th>sero_specificity</th>
      <td><p>Specificity of the serology test</p></td>
    </tr>
    <tr>
      <th>sero_sensitivity</th>
      <td><p>Sensitivity of the serology test</p></td>
    </tr>
    <tr>
      <th>progression</th>
      <td><p>Progression data</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>Change in contact rate for carehome residents</p></td>
    </tr>
    <tr>
      <th>m_CHW</th>
      <td><p>Contact rate between carehome workers and either
residents or workers</p></td>
    </tr>
    <tr>
      <th>m_CHR</th>
      <td><p>Contact rate between carehome residents</p></td>
    </tr>
    <tr>
      <th>pillar2_specificity</th>
      <td><p>Specificity of the Pillar 2 test</p></td>
    </tr>
    <tr>
      <th>pillar2_sensitivity</th>
      <td><p>Sensitivity of the Pillar 2 test</p></td>
    </tr>
    <tr>
      <th>react_specificity</th>
      <td><p>Specificity of the REACT test</p></td>
    </tr>
    <tr>
      <th>react_sensitivity</th>
      <td><p>Sensitivity of the REACT test</p></td>
    </tr>
    <tr>
      <th>p_NC</th>
      <td><p>Proportion of population who do not have
covid but have covid-like symptoms</p></td>
    </tr>
    <tr>
      <th>strain_transmission</th>
      <td><p>Vector of relative transmissibility of each
strain modelled. First element should be 1. Length will define the
number of strains used in the model</p></td>
    </tr>
    <tr>
      <th>strain_seed_date</th>
      <td><p>Either <code>NULL</code> (no seeding) or a vector of
exactly two <a href='sircovid_date.html'>sircovid_date</a> values corresponding to
the start and stop dates of seeding (inclusive). For example, to
seed for a single day, these two values should have the same
date</p></td>
    </tr>
    <tr>
      <th>strain_seed_value</th>
      <td><p>Either <code>NULL</code> (no seeding) or a single
integer value represending the <em>daily</em> rate of seeding. Because
each day is dividied into <code>1 / dt</code> steps, this value will be
spread out fairly evenly across the steps that occur within each
date. Seeding is not stochastic; this many individuals <em>will</em>
become infected with the new strain, unless the pool of
susceptibles has been exhausted.</p></td>
    </tr>
    <tr>
      <th>rel_susceptibility</th>
      <td><p>A vector or matrix of values representing the
relative susceptibility of individuals in different vaccination groups.
If a vector, the first value should be 1 (for the non-vaccinated group)
and subsequent values be between 0 and 1. In that case relative
susceptibility will be the same across all age groups within one
vaccination category. Specifying a matrix instead of a vector allows
different relative susceptibilities by age (rows of the matrix) and
vaccination group (columns of the matrix); in that case, in each row of
the matrix, the first value should be 1 (for the non-vaccinated group)
and subsequent values be between 0 and 1</p></td>
    </tr>
    <tr>
      <th>rel_p_sympt</th>
      <td><p>A vector or matrix of values of same dimension as
rel_susceptibility representing the
relative probability of symptomatic infection in different
vaccination groups. If a vector, the first value should be 1 (for the
non-vaccinated group) and subsequent values be between 0 and 1.
In that case the relative reduction in probability of symptomatic
infection will be the same across all age groups within one vaccination
category.
Specifying a matrix instead of a vector allows different relative
reductions in probability of symptomatic infection by age (rows of the
matrix) and vaccination group (columns of the matrix); in that case,
in each row of the matrix, the first value should be 1 (for the
non-vaccinated group) and subsequent values be between 0 and 1</p></td>
    </tr>
    <tr>
      <th>rel_p_hosp_if_sympt</th>
      <td><p>A vector or matrix of values of same dimension as
rel_susceptibility representing the
relative probability of hospitalisation for symptomatic cases in different
vaccination groups. If a vector, the first value should be 1 (for the
non-vaccinated group) and subsequent values be between 0 and 1.
In that case the relative reduction in probability of hospitalisation for
symptomatic cases will be the same across all age groups within one
vaccination category.
Specifying a matrix instead of a vector allows different relative
reductions in probability of hospitalisation for symptomatic cases by age
(rows of the matrix) and vaccination group (columns of the matrix);
in that case, in each row of the matrix, the first value should be 1
(for the non-vaccinated group) and subsequent values be between 0 and 1</p></td>
    </tr>
    <tr>
      <th>rel_infectivity</th>
      <td><p>A vector or matrix of values representing the
relative infectivity of individuals in different vaccination groups,
if they are infected.
If a vector, the first value should be 1 (for the non-vaccinated group)
and subsequent values be between 0 and 1. In that case relative
infectivity will be the same across all age groups within one
vaccination category. Specifying a matrix instead of a vector allows
different relative infectivities by age (rows of the matrix) and
vaccination group (columns of the matrix); in that case, in each row of
the matrix, the first value should be 1 (for the non-vaccinated group)
and subsequent values be between 0 and 1</p></td>
    </tr>
    <tr>
      <th>vaccine_progression_rate</th>
      <td><p>A vector or matrix of values of same
dimension as rel_susceptibility representing
the rate of movement between different vaccination classes. If a vector,
it should have as many values as vaccination classes, and the same rates
of progression will be used for all age
groups (the first rate is the vaccination rate and the last of the rates
is the rate of returning to the initial
vacination class); if a matrix, the element on row i and column j is the
rate of progression from the jth vaccination class to the (j+1)th for age
group i.</p></td>
    </tr>
    <tr>
      <th>vaccine_uptake</th>
      <td><p>A vector of length 19 with the proportion of
the population who are able to be vaccinated.</p></td>
    </tr>
    <tr>
      <th>vaccine_daily_doses</th>
      <td><p>A single value indicating the number of
(first) vaccine doses per day to distribute. The actual number
distributed will be stochastically distributed around this,
provided there are sufficient eligible candidates.</p></td>
    </tr>
    <tr>
      <th>waning_rate</th>
      <td><p>A single value or a vector of values representing the
rates of waning of immunity after infection; if a single value the same
rate is used for all age groups; if a vector of values if used it should
have one value per age group.</p></td>
    </tr>
    <tr>
      <th>model_pcr_and_serology_user</th>
      <td><p>A value of 1 or 0 so switch on or off the
flows out of T_PCR_neg and T_sero_neg and the corresponding cap on the
number of individuals leaving the R compartments</p></td>
    </tr>
    <tr>
      <th>exp_noise</th>
      <td><p>Rate of exponential noise used in the compare
function - typically set to a large value so that noise is small
but non-zero. If set to <code>Inf</code> then there is no noise in the
observation process (not realistic but useful for testing).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of inputs to the model, many of which are fixed and
represent data. These correspond largely to <code>user()</code> calls
within the odin code, though some are also used in processing
just before the model is run.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>carehomes_parameters</span><span class='op'>(</span><span class='fu'><a href='sircovid_date.html'>sircovid_date</a></span><span class='op'>(</span><span class='st'>"2020-02-01"</span><span class='op'>)</span>, <span class='st'>"uk"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $hosp_transmission
#&gt; [1] 0.1
#&gt; 
#&gt; $ICU_transmission
#&gt; [1] 0.05
#&gt; 
#&gt; $G_D_transmission
#&gt; [1] 0.05
#&gt; 
#&gt; $dt
#&gt; [1] 0.25
#&gt; 
#&gt; $initial_step
#&gt; [1] 128
#&gt; 
#&gt; $n_age_groups
#&gt; [1] 17
#&gt; 
#&gt; $beta_step
#&gt; [1] 0.08
#&gt; 
#&gt; $population
#&gt;  [1] 3857263 4149852 3953866 3656968 4153080 4514249 4497132 4395667 4019539
#&gt; [10] 4402122 4661015 4405908 3755185 3368199 3318867 2325296 3362599
#&gt; 
#&gt; $carehome_beds
#&gt; [1] 537521
#&gt; 
#&gt; $carehome_residents
#&gt; [1] 398841
#&gt; 
#&gt; $carehome_workers
#&gt; [1] 398841
#&gt; 
#&gt; $m
#&gt;                 [0,4)        [5,9)      [10,14)      [15,19)      [20,24)
#&gt; [0,4)    4.966707e-07 1.980202e-07 1.146078e-07 7.547886e-08 1.138137e-07
#&gt; [5,9)    1.980202e-07 1.599396e-06 2.972491e-07 1.352721e-07 1.101069e-07
#&gt; [10,14)  1.146078e-07 2.972491e-07 1.733225e-06 3.334453e-07 6.026086e-08
#&gt; [15,19)  7.547886e-08 1.352721e-07 3.334453e-07 1.836025e-06 3.278825e-07
#&gt; [20,24)  1.138137e-07 1.101069e-07 6.026086e-08 3.278825e-07 6.244090e-07
#&gt; [25,29)  1.819153e-07 1.626085e-07 8.744544e-08 1.819264e-07 3.222430e-07
#&gt; [30,34)  1.940880e-07 2.332740e-07 1.297928e-07 1.120304e-07 1.882853e-07
#&gt; [35,39)  2.235471e-07 2.784775e-07 2.396054e-07 1.996738e-07 1.624326e-07
#&gt; [40,44)  9.944949e-08 2.332186e-07 2.679243e-07 2.341623e-07 1.838660e-07
#&gt; [45,49)  6.175863e-08 8.096090e-08 1.519569e-07 2.467186e-07 2.148012e-07
#&gt; [50,54)  8.214138e-08 7.752704e-08 8.335625e-08 1.392241e-07 1.530723e-07
#&gt; [55,59)  6.104769e-08 5.013907e-08 8.513107e-08 7.833919e-08 1.178128e-07
#&gt; [60,64)  6.057159e-08 9.418311e-08 5.929099e-08 5.863294e-08 8.866898e-08
#&gt; [65,69)  4.767006e-08 7.402091e-08 6.898452e-08 9.552015e-08 7.226646e-08
#&gt; [70,74)  2.100618e-08 2.893729e-08 5.503570e-08 9.539437e-08 5.468746e-08
#&gt; [75,79)  2.100618e-08 2.893729e-08 5.503570e-08 9.539437e-08 5.468746e-08
#&gt; [80,100) 2.100618e-08 2.893729e-08 5.503570e-08 9.539437e-08 5.468746e-08
#&gt; CHW      1.205649e-07 1.512986e-07 1.380629e-07 1.563385e-07 1.788978e-07
#&gt; CHR      2.100618e-09 2.893729e-09 5.503570e-09 9.539437e-09 5.468746e-09
#&gt;               [25,29)      [30,34)      [35,39)      [40,44)      [45,49)
#&gt; [0,4)    1.819153e-07 1.940880e-07 2.235471e-07 9.944949e-08 6.175863e-08
#&gt; [5,9)    1.626085e-07 2.332740e-07 2.784775e-07 2.332186e-07 8.096090e-08
#&gt; [10,14)  8.744544e-08 1.297928e-07 2.396054e-07 2.679243e-07 1.519569e-07
#&gt; [15,19)  1.819264e-07 1.120304e-07 1.996738e-07 2.341623e-07 2.467186e-07
#&gt; [20,24)  3.222430e-07 1.882853e-07 1.624326e-07 1.838660e-07 2.148012e-07
#&gt; [25,29)  4.054957e-07 2.389792e-07 1.870791e-07 1.918110e-07 2.005309e-07
#&gt; [30,34)  2.389792e-07 3.706066e-07 2.728896e-07 2.145623e-07 1.654374e-07
#&gt; [35,39)  1.870791e-07 2.728896e-07 3.412451e-07 3.032663e-07 2.149544e-07
#&gt; [40,44)  1.918110e-07 2.145623e-07 3.032663e-07 3.370632e-07 3.085384e-07
#&gt; [45,49)  2.005309e-07 1.654374e-07 2.149544e-07 3.085384e-07 4.254147e-07
#&gt; [50,54)  1.882440e-07 1.671228e-07 1.606864e-07 1.873283e-07 1.702589e-07
#&gt; [55,59)  1.560297e-07 1.454919e-07 1.379231e-07 1.451614e-07 1.482183e-07
#&gt; [60,64)  1.189756e-07 1.374885e-07 1.668294e-07 1.791329e-07 1.414642e-07
#&gt; [65,69)  1.147535e-07 8.979643e-08 1.540697e-07 1.348771e-07 8.620090e-08
#&gt; [70,74)  4.760237e-08 3.516410e-08 4.653274e-08 1.307023e-07 1.059467e-07
#&gt; [75,79)  4.760237e-08 3.516410e-08 4.653274e-08 1.307023e-07 1.059467e-07
#&gt; [80,100) 4.760237e-08 3.516410e-08 4.653274e-08 1.307023e-07 1.059467e-07
#&gt; CHW      2.108932e-07 2.140723e-07 2.231092e-07 2.333580e-07 2.218521e-07
#&gt; CHR      4.760237e-09 3.516410e-09 4.653274e-09 1.307023e-08 1.059467e-08
#&gt;               [50,54)      [55,59)      [60,64)      [65,69)      [70,74)
#&gt; [0,4)    8.214138e-08 6.104769e-08 6.057159e-08 4.767006e-08 2.100618e-08
#&gt; [5,9)    7.752704e-08 5.013907e-08 9.418311e-08 7.402091e-08 2.893729e-08
#&gt; [10,14)  8.335625e-08 8.513107e-08 5.929099e-08 6.898452e-08 5.503570e-08
#&gt; [15,19)  1.392241e-07 7.833919e-08 5.863294e-08 9.552015e-08 9.539437e-08
#&gt; [20,24)  1.530723e-07 1.178128e-07 8.866898e-08 7.226646e-08 5.468746e-08
#&gt; [25,29)  1.882440e-07 1.560297e-07 1.189756e-07 1.147535e-07 4.760237e-08
#&gt; [30,34)  1.671228e-07 1.454919e-07 1.374885e-07 8.979643e-08 3.516410e-08
#&gt; [35,39)  1.606864e-07 1.379231e-07 1.668294e-07 1.540697e-07 4.653274e-08
#&gt; [40,44)  1.873283e-07 1.451614e-07 1.791329e-07 1.348771e-07 1.307023e-07
#&gt; [45,49)  1.702589e-07 1.482183e-07 1.414642e-07 8.620090e-08 1.059467e-07
#&gt; [50,54)  1.592838e-07 2.060829e-07 1.178586e-07 9.108480e-08 9.232320e-08
#&gt; [55,59)  2.060829e-07 2.647960e-07 1.998500e-07 1.379069e-07 8.128181e-08
#&gt; [60,64)  1.178586e-07 1.998500e-07 1.734975e-07 1.674043e-07 1.041277e-07
#&gt; [65,69)  9.108480e-08 1.379069e-07 1.674043e-07 2.089258e-07 1.332611e-07
#&gt; [70,74)  9.232320e-08 8.128181e-08 1.041277e-07 1.332611e-07 1.493131e-07
#&gt; [75,79)  9.232320e-08 8.128181e-08 1.041277e-07 1.332611e-07 1.493131e-07
#&gt; [80,100) 9.232320e-08 8.128181e-08 1.041277e-07 1.332611e-07 1.493131e-07
#&gt; CHW      1.696082e-07 1.754442e-07 1.543871e-07 1.220117e-07 8.046011e-08
#&gt; CHR      9.232320e-09 8.128181e-09 1.041277e-08 1.332611e-08 1.493131e-08
#&gt;               [75,79)     [80,100)          CHW          CHR
#&gt; [0,4)    2.100618e-08 2.100618e-08 1.205649e-07 2.100618e-09
#&gt; [5,9)    2.893729e-08 2.893729e-08 1.512986e-07 2.893729e-09
#&gt; [10,14)  5.503570e-08 5.503570e-08 1.380629e-07 5.503570e-09
#&gt; [15,19)  9.539437e-08 9.539437e-08 1.563385e-07 9.539437e-09
#&gt; [20,24)  5.468746e-08 5.468746e-08 1.788978e-07 5.468746e-09
#&gt; [25,29)  4.760237e-08 4.760237e-08 2.108932e-07 4.760237e-09
#&gt; [30,34)  3.516410e-08 3.516410e-08 2.140723e-07 3.516410e-09
#&gt; [35,39)  4.653274e-08 4.653274e-08 2.231092e-07 4.653274e-09
#&gt; [40,44)  1.307023e-07 1.307023e-07 2.333580e-07 1.307023e-08
#&gt; [45,49)  1.059467e-07 1.059467e-07 2.218521e-07 1.059467e-08
#&gt; [50,54)  9.232320e-08 9.232320e-08 1.696082e-07 9.232320e-09
#&gt; [55,59)  8.128181e-08 8.128181e-08 1.754442e-07 8.128181e-09
#&gt; [60,64)  1.041277e-07 1.041277e-07 1.543871e-07 1.041277e-08
#&gt; [65,69)  1.332611e-07 1.332611e-07 1.220117e-07 1.332611e-08
#&gt; [70,74)  1.493131e-07 1.493131e-07 8.046011e-08 1.493131e-08
#&gt; [75,79)  1.493131e-07 1.493131e-07 8.046011e-08 1.493131e-08
#&gt; [80,100) 1.493131e-07 1.493131e-07 8.046011e-08 1.493131e-08
#&gt; CHW      8.046011e-08 8.046011e-08 4.000000e-06 4.000000e-06
#&gt; CHR      1.493131e-08 1.493131e-08 4.000000e-06 5.000000e-05
#&gt; 
#&gt; $N_tot
#&gt;  [1] 3857263 4149852 3953866 3656968 4153080 4464394 4447277 4345812 3969684
#&gt; [10] 4352267 4611160 4356053 3705330 3348257 3298925 2265470 3063468  398841
#&gt; [19]  398841
#&gt; 
#&gt; $N_tot_15_64
#&gt; [1] 42062025
#&gt; 
#&gt; $sero_specificity
#&gt; [1] 0.9
#&gt; 
#&gt; $sero_sensitivity
#&gt; [1] 0.99
#&gt; 
#&gt; $pillar2_specificity
#&gt; [1] 0.99
#&gt; 
#&gt; $pillar2_sensitivity
#&gt; [1] 0.99
#&gt; 
#&gt; $react_specificity
#&gt; [1] 0.99
#&gt; 
#&gt; $react_sensitivity
#&gt; [1] 0.99
#&gt; 
#&gt; $p_NC
#&gt; [1] 0.01
#&gt; 
#&gt; $observation
#&gt; $observation$phi_ICU
#&gt; [1] 1
#&gt; 
#&gt; $observation$kappa_ICU
#&gt; [1] 2
#&gt; 
#&gt; $observation$phi_general
#&gt; [1] 1
#&gt; 
#&gt; $observation$kappa_general
#&gt; [1] 2
#&gt; 
#&gt; $observation$phi_hosp
#&gt; [1] 1
#&gt; 
#&gt; $observation$kappa_hosp
#&gt; [1] 2
#&gt; 
#&gt; $observation$phi_death_hosp
#&gt; [1] 1
#&gt; 
#&gt; $observation$kappa_death_hosp
#&gt; [1] 2
#&gt; 
#&gt; $observation$phi_death_comm
#&gt; [1] 1
#&gt; 
#&gt; $observation$kappa_death_comm
#&gt; [1] 2
#&gt; 
#&gt; $observation$kappa_death
#&gt; [1] 2
#&gt; 
#&gt; $observation$phi_admitted
#&gt; [1] 1
#&gt; 
#&gt; $observation$kappa_admitted
#&gt; [1] 2
#&gt; 
#&gt; $observation$phi_new
#&gt; [1] 1
#&gt; 
#&gt; $observation$kappa_new
#&gt; [1] 2
#&gt; 
#&gt; $observation$phi_new_admitted
#&gt; [1] 1
#&gt; 
#&gt; $observation$kappa_new_admitted
#&gt; [1] 2
#&gt; 
#&gt; $observation$phi_pillar2_cases
#&gt; [1] 1
#&gt; 
#&gt; $observation$kappa_pillar2_cases
#&gt; [1] 2
#&gt; 
#&gt; $observation$rho_pillar2_tests
#&gt; [1] 0.1
#&gt; 
#&gt; $observation$exp_noise
#&gt; [1] 1e+06
#&gt; 
#&gt; 
#&gt; $n_groups
#&gt; [1] 19
#&gt; 
#&gt; $p_star
#&gt;  [1] 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2
#&gt; 
#&gt; $p_C
#&gt;  [1] 0.1809000 0.1809000 0.1809000 0.1809000 0.2241000 0.2241000 0.2241000
#&gt;  [8] 0.2241000 0.3054000 0.3054000 0.3054000 0.3054000 0.3546000 0.3546000
#&gt; [15] 0.3546000 0.3546000 0.6456000 0.2810625 0.6456000
#&gt; 
#&gt; $p_G_D
#&gt;  [1] 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.7
#&gt; 
#&gt; $p_H_D
#&gt;  [1] 0.1258933 0.1226134 0.1356729 0.1526679 0.1743031 0.1941879 0.2093617
#&gt;  [8] 0.2244326 0.2370135 0.2578281 0.2908746 0.3207640 0.3625638 0.3909655
#&gt; [15] 0.4211515 0.4475459 0.4820000 0.2621283 0.4820000
#&gt; 
#&gt; $p_ICU_D
#&gt;  [1] 0.5234896 0.5234896 0.5234896 0.5234896 0.5234896 0.5234896 0.5234896
#&gt;  [8] 0.5234896 0.5234896 0.5234896 0.5234896 0.5234896 0.5234896 0.5234896
#&gt; [15] 0.5234896 0.5234896 0.5234896 0.5234896 0.5234896
#&gt; 
#&gt; $p_W_D
#&gt;  [1] 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05
#&gt; [16] 0.05 0.05 0.05 0.05
#&gt; 
#&gt; $p_ICU
#&gt;  [1] 0.11845387 0.11845387 0.11845387 0.11845387 0.11845387 0.11845387
#&gt;  [7] 0.11845387 0.12551064 0.14091042 0.17595537 0.24437611 0.35243489
#&gt; [13] 0.52779221 0.72404472 0.18197685 0.05439050 0.01673267 0.22548592
#&gt; [19] 0.01673267
#&gt; 
#&gt; $p_sero_pos
#&gt;  [1] 0.8212394 0.8212394 0.8212394 0.8212394 0.8212394 0.8212394 0.8212394
#&gt;  [8] 0.8212394 0.8212394 0.8212394 0.8212394 0.8212394 0.8212394 0.8212394
#&gt; [15] 0.8212394 0.8212394 0.8212394 0.8212394 0.8212394
#&gt; 
#&gt; $p_H
#&gt;  [1] 0.000632689 0.000539148 0.000995640 0.002035807 0.004545371 0.008748134
#&gt;  [7] 0.013802147 0.019850725 0.024607803 0.032822485 0.049084367 0.061571007
#&gt; [13] 0.086379194 0.099452536 0.124208801 0.150169192 0.153030303 0.037108233
#&gt; [19] 0.153030303
#&gt; 
#&gt; $psi_H
#&gt;  [1] 0.004134403 0.003523145 0.006506162 0.013303293 0.029702424 0.057166024
#&gt;  [7] 0.090192248 0.129717609 0.160803465 0.214483565 0.320749329 0.402345194
#&gt; [13] 0.564458100 0.649887859 0.811661472 0.981303631 1.000000000 0.242489442
#&gt; [19] 1.000000000
#&gt; 
#&gt; $p_H_step
#&gt; [1] 0.1530303
#&gt; 
#&gt; $psi_ICU
#&gt;  [1] 0.16360021 0.16360021 0.16360021 0.16360021 0.16360021 0.16360021
#&gt;  [7] 0.16360021 0.17334653 0.19461564 0.24301727 0.33751521 0.48675845
#&gt; [13] 0.72894974 1.00000000 0.25133371 0.07512036 0.02311000 0.31142541
#&gt; [19] 0.02311000
#&gt; 
#&gt; $p_ICU_step
#&gt; [1] 0.7240447
#&gt; 
#&gt; $psi_ICU_D
#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt; 
#&gt; $p_ICU_D_step
#&gt; [1] 0.5234896
#&gt; 
#&gt; $psi_H_D
#&gt;  [1] 0.2611893 0.2543846 0.2814790 0.3167383 0.3616246 0.4028795 0.4343604
#&gt;  [8] 0.4656277 0.4917293 0.5349130 0.6034743 0.6654854 0.7522070 0.8111317
#&gt; [15] 0.8737583 0.9285184 1.0000000 0.5438346 1.0000000
#&gt; 
#&gt; $p_H_D_step
#&gt; [1] 0.482
#&gt; 
#&gt; $psi_W_D
#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt; 
#&gt; $p_W_D_step
#&gt; [1] 0.05
#&gt; 
#&gt; $psi_G_D
#&gt;  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1
#&gt; 
#&gt; $p_G_D_step
#&gt; [1] 0.7
#&gt; 
#&gt; $psi_star
#&gt;  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
#&gt; 
#&gt; $p_star_step
#&gt; [1] 0.2
#&gt; 
#&gt; $k_E
#&gt; [1] 2
#&gt; 
#&gt; $k_A
#&gt; [1] 1
#&gt; 
#&gt; $k_C
#&gt; [1] 1
#&gt; 
#&gt; $k_G_D
#&gt; [1] 2
#&gt; 
#&gt; $k_H_D
#&gt; [1] 2
#&gt; 
#&gt; $k_H_R
#&gt; [1] 2
#&gt; 
#&gt; $k_ICU_D
#&gt; [1] 2
#&gt; 
#&gt; $k_ICU_W_R
#&gt; [1] 2
#&gt; 
#&gt; $k_ICU_W_D
#&gt; [1] 2
#&gt; 
#&gt; $k_ICU_pre
#&gt; [1] 2
#&gt; 
#&gt; $k_W_R
#&gt; [1] 2
#&gt; 
#&gt; $k_W_D
#&gt; [1] 2
#&gt; 
#&gt; $k_sero_pos
#&gt; [1] 2
#&gt; 
#&gt; $k_PCR_pre
#&gt; [1] 2
#&gt; 
#&gt; $k_PCR_pos
#&gt; [1] 2
#&gt; 
#&gt; $gamma_E
#&gt; [1] 0.4357298
#&gt; 
#&gt; $gamma_A
#&gt; [1] 0.4784689
#&gt; 
#&gt; $gamma_C
#&gt; [1] 0.25
#&gt; 
#&gt; $gamma_G_D
#&gt; [1] 0.4
#&gt; 
#&gt; $gamma_H_D
#&gt; [1] 0.4
#&gt; 
#&gt; $gamma_H_R
#&gt; [1] 0.2
#&gt; 
#&gt; $gamma_ICU_D
#&gt; [1] 0.4
#&gt; 
#&gt; $gamma_ICU_W_R
#&gt; [1] 0.2
#&gt; 
#&gt; $gamma_ICU_W_D
#&gt; [1] 0.2
#&gt; 
#&gt; $gamma_ICU_pre
#&gt; [1] 2
#&gt; 
#&gt; $gamma_W_R
#&gt; [1] 0.4
#&gt; 
#&gt; $gamma_W_D
#&gt; [1] 0.4
#&gt; 
#&gt; $gamma_sero_pre_1
#&gt; [1] 0.2
#&gt; 
#&gt; $gamma_sero_pre_2
#&gt; [1] 0.1
#&gt; 
#&gt; $gamma_sero_pos
#&gt; [1] 0.04
#&gt; 
#&gt; $gamma_U
#&gt; [1] 0.3
#&gt; 
#&gt; $gamma_PCR_pre
#&gt; [1] 0.6666667
#&gt; 
#&gt; $gamma_PCR_pos
#&gt; [1] 0.2
#&gt; 
#&gt; $n_strains
#&gt; [1] 1
#&gt; 
#&gt; $strain_transmission
#&gt; [1] 1
#&gt; 
#&gt; $strain_seed_step
#&gt; [1] 0
#&gt; 
#&gt; $rel_susceptibility
#&gt;       [,1]
#&gt;  [1,]    1
#&gt;  [2,]    1
#&gt;  [3,]    1
#&gt;  [4,]    1
#&gt;  [5,]    1
#&gt;  [6,]    1
#&gt;  [7,]    1
#&gt;  [8,]    1
#&gt;  [9,]    1
#&gt; [10,]    1
#&gt; [11,]    1
#&gt; [12,]    1
#&gt; [13,]    1
#&gt; [14,]    1
#&gt; [15,]    1
#&gt; [16,]    1
#&gt; [17,]    1
#&gt; [18,]    1
#&gt; [19,]    1
#&gt; 
#&gt; $rel_p_sympt
#&gt;       [,1]
#&gt;  [1,]    1
#&gt;  [2,]    1
#&gt;  [3,]    1
#&gt;  [4,]    1
#&gt;  [5,]    1
#&gt;  [6,]    1
#&gt;  [7,]    1
#&gt;  [8,]    1
#&gt;  [9,]    1
#&gt; [10,]    1
#&gt; [11,]    1
#&gt; [12,]    1
#&gt; [13,]    1
#&gt; [14,]    1
#&gt; [15,]    1
#&gt; [16,]    1
#&gt; [17,]    1
#&gt; [18,]    1
#&gt; [19,]    1
#&gt; 
#&gt; $rel_p_hosp_if_sympt
#&gt;       [,1]
#&gt;  [1,]    1
#&gt;  [2,]    1
#&gt;  [3,]    1
#&gt;  [4,]    1
#&gt;  [5,]    1
#&gt;  [6,]    1
#&gt;  [7,]    1
#&gt;  [8,]    1
#&gt;  [9,]    1
#&gt; [10,]    1
#&gt; [11,]    1
#&gt; [12,]    1
#&gt; [13,]    1
#&gt; [14,]    1
#&gt; [15,]    1
#&gt; [16,]    1
#&gt; [17,]    1
#&gt; [18,]    1
#&gt; [19,]    1
#&gt; 
#&gt; $rel_infectivity
#&gt;       [,1]
#&gt;  [1,]    1
#&gt;  [2,]    1
#&gt;  [3,]    1
#&gt;  [4,]    1
#&gt;  [5,]    1
#&gt;  [6,]    1
#&gt;  [7,]    1
#&gt;  [8,]    1
#&gt;  [9,]    1
#&gt; [10,]    1
#&gt; [11,]    1
#&gt; [12,]    1
#&gt; [13,]    1
#&gt; [14,]    1
#&gt; [15,]    1
#&gt; [16,]    1
#&gt; [17,]    1
#&gt; [18,]    1
#&gt; [19,]    1
#&gt; 
#&gt; $vaccine_progression_rate_base
#&gt;       [,1]
#&gt;  [1,]    0
#&gt;  [2,]    0
#&gt;  [3,]    0
#&gt;  [4,]    0
#&gt;  [5,]    0
#&gt;  [6,]    0
#&gt;  [7,]    0
#&gt;  [8,]    0
#&gt;  [9,]    0
#&gt; [10,]    0
#&gt; [11,]    0
#&gt; [12,]    0
#&gt; [13,]    0
#&gt; [14,]    0
#&gt; [15,]    0
#&gt; [16,]    0
#&gt; [17,]    0
#&gt; [18,]    0
#&gt; [19,]    0
#&gt; 
#&gt; $vaccine_population_reluctant
#&gt;  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; 
#&gt; $vaccine_daily_doses
#&gt; [1] 0
#&gt; 
#&gt; $waning_rate
#&gt;  [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; 
#&gt; $model_pcr_and_serology_user
#&gt; [1] 1
#&gt; </div><div class='input'>
<span class='co'># example set up of vaccination parameters independent of age</span>
<span class='co'># 3 groups: 1) unvaccinated, 2) vaccinated with partial immunity</span>
<span class='co'># 3) fully vaccinated (but with an imperfect vaccine). People return</span>
<span class='co'># to group 1 after a period of time in group 3 to mirror waning immunity</span>

<span class='co'># Assumption: immediately after vaccination susceptibility is reduced by</span>
<span class='co'># 20%, and then by 50% when you reach full effect of the vaccination,</span>
<span class='co'># then susceptibility returns to 100% upon waning of vaccine=induced</span>
<span class='co'># immunity</span>
<span class='co'># effect of vaccination similar across all age groups</span>
<span class='va'>rel_susceptibility</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.8</span>, <span class='fl'>0.5</span><span class='op'>)</span>

<span class='co'># The vaccine also reduces the risk of symptoms</span>
<span class='va'>rel_p_sympt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.6</span>, <span class='fl'>0.3</span><span class='op'>)</span>
<span class='co'># and the risk of hospitalisation for those with symptoms</span>
<span class='va'>rel_p_hosp_if_sympt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.95</span>, <span class='fl'>0.95</span><span class='op'>)</span>

<span class='co'># The vaccine also reduces infectivity of infected individuals by half</span>
<span class='va'>rel_infectivity</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.5</span>, <span class='fl'>0.5</span><span class='op'>)</span>

<span class='co'># Vaccination occurs at a constant rate of 0.03 per day,</span>
<span class='co'># (i.e. average time to vaccination is 33 days)</span>
<span class='co'># similar across all age groups.</span>
<span class='co'># the period of build-up of immunity following vaccination is exponentially</span>
<span class='co'># distributed and lasts on average two weeks;</span>
<span class='co'># vaccine-induced immunity wanes after a period which is exponentially</span>
<span class='co'># distributed and lasts on average 26 weeks (half a year);</span>
<span class='co'># they are similar across all age groups</span>
<span class='va'>vaccine_progression_rate</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>2</span><span class='op'>*</span><span class='fl'>7</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>26</span><span class='op'>*</span><span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># generate model parameters</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'>carehomes_parameters</span><span class='op'>(</span>
       <span class='fu'><a href='sircovid_date.html'>sircovid_date</a></span><span class='op'>(</span><span class='st'>"2020-02-01"</span><span class='op'>)</span>, <span class='st'>"uk"</span>,
       rel_susceptibility <span class='op'>=</span> <span class='va'>rel_susceptibility</span>,
       rel_p_sympt <span class='op'>=</span> <span class='va'>rel_p_sympt</span>,
       rel_p_hosp_if_sympt <span class='op'>=</span> <span class='va'>rel_p_hosp_if_sympt</span>,
       rel_infectivity <span class='op'>=</span> <span class='va'>rel_infectivity</span>,
       vaccine_progression_rate <span class='op'>=</span> <span class='va'>vaccine_progression_rate</span>,
       vaccine_daily_doses <span class='op'>=</span> <span class='fl'>10000</span><span class='op'>)</span>

<span class='co'># vaccination parameters are automatically copied across all age groups</span>
<span class='va'>p</span><span class='op'>$</span><span class='va'>rel_susceptibility</span>
</div><div class='output co'>#&gt;       [,1] [,2] [,3]
#&gt;  [1,]    1  0.8  0.5
#&gt;  [2,]    1  0.8  0.5
#&gt;  [3,]    1  0.8  0.5
#&gt;  [4,]    1  0.8  0.5
#&gt;  [5,]    1  0.8  0.5
#&gt;  [6,]    1  0.8  0.5
#&gt;  [7,]    1  0.8  0.5
#&gt;  [8,]    1  0.8  0.5
#&gt;  [9,]    1  0.8  0.5
#&gt; [10,]    1  0.8  0.5
#&gt; [11,]    1  0.8  0.5
#&gt; [12,]    1  0.8  0.5
#&gt; [13,]    1  0.8  0.5
#&gt; [14,]    1  0.8  0.5
#&gt; [15,]    1  0.8  0.5
#&gt; [16,]    1  0.8  0.5
#&gt; [17,]    1  0.8  0.5
#&gt; [18,]    1  0.8  0.5
#&gt; [19,]    1  0.8  0.5</div><div class='input'><span class='va'>p</span><span class='op'>$</span><span class='va'>rel_p_sympt</span>
</div><div class='output co'>#&gt;       [,1] [,2] [,3]
#&gt;  [1,]    1  0.6  0.3
#&gt;  [2,]    1  0.6  0.3
#&gt;  [3,]    1  0.6  0.3
#&gt;  [4,]    1  0.6  0.3
#&gt;  [5,]    1  0.6  0.3
#&gt;  [6,]    1  0.6  0.3
#&gt;  [7,]    1  0.6  0.3
#&gt;  [8,]    1  0.6  0.3
#&gt;  [9,]    1  0.6  0.3
#&gt; [10,]    1  0.6  0.3
#&gt; [11,]    1  0.6  0.3
#&gt; [12,]    1  0.6  0.3
#&gt; [13,]    1  0.6  0.3
#&gt; [14,]    1  0.6  0.3
#&gt; [15,]    1  0.6  0.3
#&gt; [16,]    1  0.6  0.3
#&gt; [17,]    1  0.6  0.3
#&gt; [18,]    1  0.6  0.3
#&gt; [19,]    1  0.6  0.3</div><div class='input'><span class='va'>p</span><span class='op'>$</span><span class='va'>rel_p_hosp_if_sympt</span>
</div><div class='output co'>#&gt;       [,1] [,2] [,3]
#&gt;  [1,]    1 0.95 0.95
#&gt;  [2,]    1 0.95 0.95
#&gt;  [3,]    1 0.95 0.95
#&gt;  [4,]    1 0.95 0.95
#&gt;  [5,]    1 0.95 0.95
#&gt;  [6,]    1 0.95 0.95
#&gt;  [7,]    1 0.95 0.95
#&gt;  [8,]    1 0.95 0.95
#&gt;  [9,]    1 0.95 0.95
#&gt; [10,]    1 0.95 0.95
#&gt; [11,]    1 0.95 0.95
#&gt; [12,]    1 0.95 0.95
#&gt; [13,]    1 0.95 0.95
#&gt; [14,]    1 0.95 0.95
#&gt; [15,]    1 0.95 0.95
#&gt; [16,]    1 0.95 0.95
#&gt; [17,]    1 0.95 0.95
#&gt; [18,]    1 0.95 0.95
#&gt; [19,]    1 0.95 0.95</div><div class='input'><span class='va'>p</span><span class='op'>$</span><span class='va'>rel_infectivity</span>
</div><div class='output co'>#&gt;       [,1] [,2] [,3]
#&gt;  [1,]    1  0.5  0.5
#&gt;  [2,]    1  0.5  0.5
#&gt;  [3,]    1  0.5  0.5
#&gt;  [4,]    1  0.5  0.5
#&gt;  [5,]    1  0.5  0.5
#&gt;  [6,]    1  0.5  0.5
#&gt;  [7,]    1  0.5  0.5
#&gt;  [8,]    1  0.5  0.5
#&gt;  [9,]    1  0.5  0.5
#&gt; [10,]    1  0.5  0.5
#&gt; [11,]    1  0.5  0.5
#&gt; [12,]    1  0.5  0.5
#&gt; [13,]    1  0.5  0.5
#&gt; [14,]    1  0.5  0.5
#&gt; [15,]    1  0.5  0.5
#&gt; [16,]    1  0.5  0.5
#&gt; [17,]    1  0.5  0.5
#&gt; [18,]    1  0.5  0.5
#&gt; [19,]    1  0.5  0.5</div><div class='input'><span class='co'># Note that this is only the "base" rate as we fill in the first</span>
<span class='co'># column dynamically based on vaccine_daily_doses</span>
<span class='va'>p</span><span class='op'>$</span><span class='va'>vaccine_progression_rate</span>
</div><div class='output co'>#&gt;       [,1]       [,2]        [,3]
#&gt;  [1,]    0 0.07142857 0.005494505
#&gt;  [2,]    0 0.07142857 0.005494505
#&gt;  [3,]    0 0.07142857 0.005494505
#&gt;  [4,]    0 0.07142857 0.005494505
#&gt;  [5,]    0 0.07142857 0.005494505
#&gt;  [6,]    0 0.07142857 0.005494505
#&gt;  [7,]    0 0.07142857 0.005494505
#&gt;  [8,]    0 0.07142857 0.005494505
#&gt;  [9,]    0 0.07142857 0.005494505
#&gt; [10,]    0 0.07142857 0.005494505
#&gt; [11,]    0 0.07142857 0.005494505
#&gt; [12,]    0 0.07142857 0.005494505
#&gt; [13,]    0 0.07142857 0.005494505
#&gt; [14,]    0 0.07142857 0.005494505
#&gt; [15,]    0 0.07142857 0.005494505
#&gt; [16,]    0 0.07142857 0.005494505
#&gt; [17,]    0 0.07142857 0.005494505
#&gt; [18,]    0 0.07142857 0.005494505
#&gt; [19,]    0 0.07142857 0.005494505</div><div class='input'>
<span class='co'>### same example as above BUT assume a different effect of vaccine in the</span>
<span class='co'>### first age group</span>
<span class='va'>n_groups</span> <span class='op'>&lt;-</span> <span class='fl'>19</span>

<span class='co'># Assumption: vaccine is twice more effective at reducing susceptibility</span>
<span class='co'># in the first age group</span>
<span class='va'>rel_susceptibility_agegp1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.4</span>, <span class='fl'>0.25</span><span class='op'>)</span>
<span class='va'>rel_susceptibility_other_agegp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>0.8</span>, <span class='fl'>0.5</span><span class='op'>)</span>
<span class='va'>rel_susceptibility</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='cn'>NA</span>, nrow <span class='op'>=</span> <span class='va'>n_groups</span>, ncol <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>rel_susceptibility</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>rel_susceptibility_agegp1</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='va'>n_groups</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>rel_susceptibility</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>rel_susceptibility_other_agegp</span>
<span class='op'>}</span>
<span class='va'>rel_susceptibility</span>
</div><div class='output co'>#&gt;       [,1] [,2] [,3]
#&gt;  [1,]    1  0.4 0.25
#&gt;  [2,]    1  0.8 0.50
#&gt;  [3,]    1  0.8 0.50
#&gt;  [4,]    1  0.8 0.50
#&gt;  [5,]    1  0.8 0.50
#&gt;  [6,]    1  0.8 0.50
#&gt;  [7,]    1  0.8 0.50
#&gt;  [8,]    1  0.8 0.50
#&gt;  [9,]    1  0.8 0.50
#&gt; [10,]    1  0.8 0.50
#&gt; [11,]    1  0.8 0.50
#&gt; [12,]    1  0.8 0.50
#&gt; [13,]    1  0.8 0.50
#&gt; [14,]    1  0.8 0.50
#&gt; [15,]    1  0.8 0.50
#&gt; [16,]    1  0.8 0.50
#&gt; [17,]    1  0.8 0.50
#&gt; [18,]    1  0.8 0.50
#&gt; [19,]    1  0.8 0.50</div><div class='input'>
<span class='co'># But vaccine has the same impact on probability of symptoms and</span>
<span class='co'># hospitalisation for the symptomatic across all age groups</span>
<span class='va'>rel_p_sympt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>rel_p_sympt</span>, <span class='va'>n_groups</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='va'>n_groups</span>,
  byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>rel_p_hosp_if_sympt</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>rel_p_hosp_if_sympt</span>, <span class='va'>n_groups</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='va'>n_groups</span>, byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># And vaccine has the same impact on onwards infectivity across age groups</span>
<span class='va'>rel_infectivity</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>rel_infectivity</span>, <span class='va'>n_groups</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='va'>n_groups</span>,
  byrow <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># the period of build-up of immunity is the same for all age groups,</span>
<span class='co'># lasting on average 2 weeks,</span>
<span class='co'># but the first age group loses immunity more quickly</span>
<span class='co'># (on average after 3 months) than the other age groups</span>
<span class='co'># (on average after 6 months)</span>
<span class='va'>vaccine_progression_rate</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fl'>0</span>,
                                  <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='fl'>2</span> <span class='op'>*</span> <span class='fl'>7</span><span class='op'>)</span>, <span class='va'>n_groups</span><span class='op'>)</span>,
                                  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='fl'>13</span> <span class='op'>*</span> <span class='fl'>7</span><span class='op'>)</span>,
                                  <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span> <span class='fl'>1</span> <span class='op'>/</span> <span class='op'>(</span><span class='fl'>26</span> <span class='op'>*</span> <span class='fl'>7</span><span class='op'>)</span>, <span class='va'>n_groups</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># generate model parameters</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'>carehomes_parameters</span><span class='op'>(</span>
       <span class='fu'><a href='sircovid_date.html'>sircovid_date</a></span><span class='op'>(</span><span class='st'>"2020-02-01"</span><span class='op'>)</span>, <span class='st'>"uk"</span>,
       rel_susceptibility <span class='op'>=</span> <span class='va'>rel_susceptibility</span>,
       rel_p_sympt <span class='op'>=</span> <span class='va'>rel_p_sympt</span>,
       rel_p_hosp_if_sympt <span class='op'>=</span> <span class='va'>rel_p_hosp_if_sympt</span>,
       rel_infectivity <span class='op'>=</span> <span class='va'>rel_infectivity</span>,
       vaccine_progression_rate <span class='op'>=</span> <span class='va'>vaccine_progression_rate</span>,
       vaccine_daily_doses <span class='op'>=</span> <span class='fl'>10000</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Marc Baguelin, Edward Knock, Lilith Whittles, Rich FitzJohn, John Lees, Anne Cori.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


